{% extends 'layout.html' %}

{% block layout-content %}
<p>A <b>unit inquiry</b> lets you make requests
for changes to your set of units.
Here you can open new inquiries
and see the status of previous ones.</p>
<p>I try to respond to inquiries somewhat regularly,
but if I don't get to yours for a few days,
please send me a reminder.</p>

<h2>New inquiry</h2>
{% include "generic-form.html" with submit_name="Inquire" %}

<h2>Current inquiries</h2>
<table>
	<tr>
		<th>Created</th>
		<th>Status</th>
		<th>Action</th>
		<th>Unit</th>
		<th>Last change</th>
	</tr>
	{% for inquiry in inquiries %}
	<tr>
		<td>{{ inquiry.created_at|date:"Y-m-d" }}</td>
		<td>
			{% if inquiry.status == "NEW" %}
			Pending
			{% elif inquiry.status == "ACC" %}
			<b style="color:green;">Approved</b>
			{% elif inquiry.status == "REJ" %}
			<b style="color:red;">Rejected</b>
			{% elif inquiry.status == "HOLD" %}
			<b style="color:orange;">On hold</b>
			{% endif %}
		</td>
		<td>{{ inquiry.action_type }}</td>
		<td>{{ inquiry.unit }}</td>
		<td>
			{% if inquiry.status == "NEW" %}
			{% if request.user.is_staff %}
			<a href="{% url "approve-inquiry" inquiry.id %}">(approve)</a>
			{% else %}
			(none)
			{% endif %}
			{% else %}
			{{ inquiry.updated_at|date:"Y-m-d" }}
			{% endif %}

			{% if request.user.is_staff %}
			<a href="{% url "edit-inquiry" inquiry.id %}">(edit)</a>
			{% endif %}
		</td>
	</tr>
	{% if inquiry.explanation %}
	<tr>
	<td></td>
	<td></td>
	<td colspan="3"><i>{{ inquiry.explanation }}</i></td>
	</tr>
	{% endif %}
	{% endfor %}
</table>

<h2>Current units</h2>
<p>For your reference, here is the existing curriculum.</p>
{% include 'dashboard/list_curriculum.html' %}

<h2>Instructions</h2>
<p>An explanation of the three action types:
<ul>
	<li><b>Drop</b>: this removes a unit entirely from your list.
		If the unit is marked as current (&star;),
		then the choice of current unit will reset as well.</li>
	<li><b>Mark current</b>:
		this marks a unit as current (&star;)
		so that you can access its handout.
		If you specify a unit that you don't already have,
		then that unit will also be added to your list.</li>
	<li><b>Add unit</b>:
		This adds a unit to your list.
		Because of the silly way in which the curriculum management
		is set up, you might not immediately get access to the unit,
		or it might block off later units.
		I hope to fix this in future years.
		For now, you can see the global order of units in
		<a href="{% url "currshow" student.id %}">class selection</a>
		so you can tell where the unit will get inserted.</li>
</ul>
</p>
<p>Requests to DROP a unit are approved automatically.
Other unit inquiries are processed manually.</p>

{% include 'dashboard/back_link.html' %}
{% endblock %}
