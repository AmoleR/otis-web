{% extends 'layout.html' %}
{% load static %}

{% block layout-content %}
<p>Payment information linked can be found in the OTIS
<a href="//web.evanchen.cc/upload/otis-syllabus.pdf">syllabus</a>
and in more detail in the
<a href="//web.evanchen.cc/private/parent-info.pdf">parent info</a>.
All quantities below are in <strong>US dollars (USD)</strong>.</p>

<hr />

{% if invoice %}
<h1>Invoice</h1>
<div class="container">
	<div class="row">
		<div class="col-4">
			<img width="150px" src="{% static 'img/otis-logo-v2018.svg' %}" /> <br/>
			<tt>web.evanchen.cc</tt>
		</div>
		<div class="col">
			<table class="table">
				<tr>
					<th>Bill to</th>
					<td>{{ invoice.student.name }}</td>
				</tr>
				<tr>
					<th>Course</th>
					<td>{{ invoice.student.semester }}</td>
				</tr>
				<tr>
					<th>Date</th>
					<td>{{ invoice.updated_at|date:"Y-m-d" }}</td>
				</tr>
				<tr>
					<th>Invoice #</th>
					<td>{{ invoice.student.id|stringformat:"07d" }}</td>
				</tr>
			</table>
		</div>
	</div>
</div>
<center>
<table class="table">
<tbody>
	<thead class="thead-dark">
	<tr>
		<th class="text-center" colspan="2">Item</th>
		<th class="text-center">Amount</th>
	</tr>
	</thead>

	<tbody>
	<tr>
		<td>Semesters</td>
		<td>${{ invoice.prep_rate }} &times; {{ invoice.preps_taught }}</td>
		<td class="text-right">{{ invoice.prep_total|floatformat:2 }}</td>
	</tr>
	<tr>
		<td>Hourly</td>
		<td>${{ invoice.hour_rate }} &times; {{ invoice.hours_taught }}</td>
		<td class="text-right">{{ invoice.hours_total|floatformat:2 }}</td>
	</tr>
	<tr>
		<td colspan="2">Extras</td>
		<td class="text-right">{{ invoice.extras|stringformat:"+.2f" }}</td>
	</tr>
	<tr>
		<td colspan="2">Adjustment</td>
		<td class="text-right">{{ invoice.adjustment|stringformat:"+.2f" }}</td>
	</tr>
	<tr>
		<td colspan="2">Total cost</td>
		<td class="text-right">{{ invoice.total_cost }}</td>
	</tr>
	<tr>
		<td colspan="2">Total paid</td>
		<td class="text-right">{{ invoice.total_paid }}</td>
	</tr>
	</tbody>

	<tfoot>
	<tr>
		<th colspan="2">Total owed to Evan</th>
		{% if invoice.total_owed <= 0 %}
			<th class="text-success text-right">{{ invoice.total_owed }}</th>
		{% else %}
			<th class="text-danger text-right">{{ invoice.total_owed }}</th>
		{% endif %}
	</tr>
	</tfoot>
</table>
</center>

<hr />

<p>This invoice was last updated on {{ invoice.updated_at }} server time.</p>
<p>Please contact me if you think there are any errors
(I make mistakes every year!).
Detailed invoices with full dates, lecture names, et cetera
are available on request.</p>
<p>If you have an assistant instructor,
that payment should be done separately.</p>

	{% if request.user.is_staff %}
	<ul>
	<li>(Staff) <a href="{% url "edit-invoice" invoice.id %}">Edit invoice</a></li>
	</ul>
	{% endif %}

{% else %}
<p><b>No invoice is currently available.</b></p>
{% endif %}

{% include 'dashboard/back_link.html' %}
{% endblock %}
